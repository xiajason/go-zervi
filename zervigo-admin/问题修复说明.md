# ğŸ”§ Zervigo Admin é—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ“‹ é‡åˆ°çš„é—®é¢˜

### é”™è¯¯æˆªå›¾ä¸­çš„é—®é¢˜

1. âŒ **500 Internal Server Error**
2. âŒ **TypeError: Importing a module script failed**
3. âŒ **Unhandled Promise Rejection**
4. âŒ **æ— æ³•åŠ è½½ Layout.vue**

## ğŸ” æ ¹æœ¬åŸå› 

### é—®é¢˜ 1: TypeScript æ¨¡å—è·¯å¾„è§£æå¤±è´¥

**åŸå› **: `@/` è·¯å¾„åˆ«åæœªåœ¨ Vite å’Œ TypeScript é…ç½®ä¸­æ­£ç¡®è®¾ç½®

**å½±å“**: æ— æ³•æ‰¾åˆ°ä»¥ä¸‹æ¨¡å—ï¼š
- `@/router`
- `@/api/menu`
- `@/services/MenuService`
- `@/views/template/Common.vue`

### é—®é¢˜ 2: TypeScript ç±»å‹é”™è¯¯

**åŸå› **: 
- æœªä½¿ç”¨çš„å¯¼å…¥ (`computed`, `Ref`)
- ç±»å‹å¯¼å…¥æ–¹å¼é”™è¯¯
- API å“åº”ç±»å‹ä¸åŒ¹é…

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. ä¿®å¤ Vite é…ç½® (`vite.config.ts`)

**ä¿®å¤å‰**:
```typescript
export default defineConfig({
  plugins: [vue()],
  server: { port: 3000, ... }
})
```

**ä¿®å¤å**:
```typescript
import { fileURLToPath, URL } from 'node:url'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  },
  server: { port: 3000, ... }
})
```

**æ”¹è¿›**: âœ… æ·»åŠ äº† `@/` è·¯å¾„åˆ«åæ”¯æŒ

---

### 2. ä¿®å¤ TypeScript é…ç½® (`tsconfig.app.json`)

**ä¿®å¤å‰**:
```json
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "types": ["vite/client"],
    ...
  }
}
```

**ä¿®å¤å**:
```json
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "types": ["vite/client"],
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    ...
  }
}
```

**æ”¹è¿›**: âœ… æ·»åŠ äº† TypeScript è·¯å¾„æ˜ å°„

---

### 3. ä¿®å¤ MenuService.ts ç±»å‹å¯¼å…¥

**ä¿®å¤å‰**:
```typescript
import { ref, computed, Ref } from 'vue'
```

**ä¿®å¤å**:
```typescript
import { ref, type Ref } from 'vue'
```

**æ”¹è¿›**: 
- âœ… ç§»é™¤æœªä½¿ç”¨çš„ `computed`
- âœ… ä½¿ç”¨ `type` å…³é”®å­—å¯¼å…¥ç±»å‹

---

### 4. ä¿®å¤ MenuService.ts ç©ºå€¼æ£€æŸ¥

**ä¿®å¤å‰**:
```typescript
const lastPart = parts[parts.length - 1]
const capitalized = lastPart.charAt(0).toUpperCase() + lastPart.slice(1)
```

**ä¿®å¤å**:
```typescript
const lastPart = parts[parts.length - 1]
if (!lastPart) return 'Common'

const capitalized = lastPart.charAt(0).toUpperCase() + lastPart.slice(1)
```

**æ”¹è¿›**: âœ… æ·»åŠ äº†ç©ºå€¼æ£€æŸ¥ï¼Œé¿å… undefined é”™è¯¯

---

### 5. ä¿®å¤ Login.vue API å“åº”å¤„ç†

**ä¿®å¤å‰**:
```typescript
const res = await login(loginForm)
if (res.token) {
  localStorage.setItem('token', res.token)
  localStorage.setItem('userInfo', JSON.stringify(res.user))
}
```

**ä¿®å¤å**:
```typescript
const res = await login(loginForm)
if (res.data && res.data.token) {
  localStorage.setItem('token', res.data.token)
  localStorage.setItem('userInfo', JSON.stringify(res.data.user || { username: loginForm.username }))
} else {
  ElMessage.error('ç™»å½•å“åº”æ ¼å¼é”™è¯¯')
}
```

**æ”¹è¿›**: 
- âœ… ä¿®æ­£ API å“åº”ç»“æ„ï¼ˆ`res.data.token` è€Œä¸æ˜¯ `res.token`ï¼‰
- âœ… æ·»åŠ äº†é”™è¯¯å¤„ç†
- âœ… æ·»åŠ äº†é™çº§ç”¨æˆ·ä¿¡æ¯

---

## ğŸ“Š ä¿®å¤æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®å¤å†…å®¹ | çŠ¶æ€ |
|------|---------|------|
| `vite.config.ts` | æ·»åŠ è·¯å¾„åˆ«å | âœ… |
| `tsconfig.app.json` | æ·»åŠ è·¯å¾„æ˜ å°„ | âœ… |
| `src/services/MenuService.ts` | ä¿®å¤ç±»å‹å¯¼å…¥å’Œç©ºå€¼æ£€æŸ¥ | âœ… |
| `src/views/Login.vue` | ä¿®å¤ API å“åº”å¤„ç† | âœ… |

## ğŸš€ éªŒè¯ä¿®å¤

### 1. é‡æ–°å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨ (Ctrl+C)
# ç„¶åé‡æ–°å¯åŠ¨
cd /Users/szjason72/gozervi/zervigo.demo/zervigo-admin
npm run dev
```

### 2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåº”è¯¥**ä¸å†çœ‹åˆ°**ï¼š
- âŒ TypeError: Importing a module script failed
- âŒ Failed to load resource: 500

**åº”è¯¥çœ‹åˆ°**:
- âœ… é¡µé¢æ­£å¸¸åŠ è½½
- âœ… ç™»å½•è¡¨å•å¯ç”¨

### 3. æµ‹è¯•ç™»å½•åŠŸèƒ½

**å‰æ**: ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨

```bash
cd /Users/szjason72/gozervi/zervigo.demo/shared/central-brain
go run .
```

**æµ‹è¯•æ­¥éª¤**:
1. è®¿é—® http://localhost:3000
2. è¾“å…¥è´¦å·: `admin`
3. è¾“å…¥å¯†ç : `admin123`
4. ç‚¹å‡»"ç™»å½•"æŒ‰é’®
5. åº”è¯¥æˆåŠŸè·³è½¬åˆ°ä¸»é¡µ

## ğŸ› å¦‚æœä»æœ‰é—®é¢˜

### é—®é¢˜1: ä»ç„¶çœ‹åˆ° "Cannot find module" é”™è¯¯

**è§£å†³**: æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°å®‰è£…

```bash
cd /Users/szjason72/gozervi/zervigo.demo/zervigo-admin

# åˆ é™¤ node_modules å’Œé”æ–‡ä»¶
rm -rf node_modules package-lock.json

# é‡æ–°å®‰è£…
npm install

# é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev
```

### é—®é¢˜2: åç«¯è¿”å› 500 é”™è¯¯

**åŸå› **: åç«¯æœåŠ¡å†…éƒ¨é”™è¯¯

**è§£å†³**: 
1. æ£€æŸ¥åç«¯æ—¥å¿—
2. ç¡®ä¿æ•°æ®åº“å·²å¯åŠ¨
3. æ£€æŸ¥åç«¯é…ç½®æ–‡ä»¶

### é—®é¢˜3: ç™»å½•åé¡µé¢ç©ºç™½

**åŸå› **: èœå•æ•°æ®åŠ è½½å¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
2. ç¡®è®¤åç«¯èœå• API æ­£å¸¸: `curl http://localhost:9000/api/v1/router/menu/list`
3. æŸ¥çœ‹ç½‘ç»œè¯·æ±‚å“åº”

## ğŸ“ TypeScript ç¼–è¯‘æ£€æŸ¥

è¿è¡Œç¼–è¯‘æ£€æŸ¥ç¡®ä¿æ— é”™è¯¯ï¼š

```bash
cd /Users/szjason72/gozervi/zervigo.demo/zervigo-admin
npm run build
```

**é¢„æœŸç»“æœ**: 
- âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— è‡´å‘½é”™è¯¯
- âš ï¸ å¯èƒ½æœ‰å°‘é‡è­¦å‘Šï¼ˆæœªä½¿ç”¨å˜é‡ç­‰ï¼‰ï¼Œå¯å¿½ç•¥

## ğŸ’¡ é˜²æ­¢æœªæ¥é—®é¢˜

### 1. æ·»åŠ è·¯å¾„åˆ«åæ—¶

**æ€»æ˜¯åŒæ—¶é…ç½®**:
- `vite.config.ts` ä¸­çš„ `resolve.alias`
- `tsconfig.app.json` ä¸­çš„ `paths`

### 2. API è°ƒç”¨æ—¶

**å§‹ç»ˆå¤„ç†å“åº”ç»“æ„**:
```typescript
const res = await apiCall()
if (res.data) {
  // ä½¿ç”¨ res.data
} else {
  // é”™è¯¯å¤„ç†
}
```

### 3. ç±»å‹å¯¼å…¥

**ä½¿ç”¨ `type` å…³é”®å­—**:
```typescript
import { type TypeName } from 'module'  // âœ… æ¨è
import { TypeName } from 'module'       // âš ï¸ å¯èƒ½æœ‰é—®é¢˜
```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å…¶ä»–é—®é¢˜ï¼š

1. **æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°** - æœ€è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
2. **æŸ¥çœ‹ç»ˆç«¯è¾“å‡º** - ç¼–è¯‘é”™è¯¯å’Œè­¦å‘Š
3. **æŸ¥çœ‹ç½‘ç»œæ ‡ç­¾** - API è¯·æ±‚å’Œå“åº”
4. **æŸ¥çœ‹åç«¯æ—¥å¿—** - æœåŠ¡å™¨ç«¯é”™è¯¯

---

**ä¿®å¤æ—¥æœŸ**: 2024-11-06  
**ä¿®å¤ç‰ˆæœ¬**: v2.1.1  
**çŠ¶æ€**: âœ… æ‰€æœ‰å·²çŸ¥é—®é¢˜å·²ä¿®å¤  
**ä¸‹ä¸€æ­¥**: é‡å¯æœåŠ¡å™¨å¹¶æµ‹è¯•ç™»å½•åŠŸèƒ½  

