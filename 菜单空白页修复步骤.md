# ğŸ”§ ä¿®å¤ç©ºç™½é¡µé—®é¢˜ - å®Œæ•´æ­¥éª¤

## âœ… å·²å®Œæˆçš„ä¿®å¤

1. âœ… ä¿®æ”¹ç™»å½•æ¥å£ï¼Œæ”¯æŒ VueCMF æ ¼å¼
2. âœ… é‡å¯ Auth Service
3. âœ… ç™»å½•åŠŸèƒ½æ­£å¸¸
4. âœ… åˆ›å»ºèœå•æ•°æ®è¡¨å’Œåˆå§‹æ•°æ®
5. âœ… æ·»åŠ èœå• API æ˜ å°„
6. âœ… åˆ›å»ºèœå•å¤„ç†å™¨

## ğŸš€ éœ€è¦å®Œæˆçš„æœ€åä¸€æ­¥

### æ–¹æ¡ˆ A: ä¸´æ—¶ä¿®è¡¥ï¼ˆæœ€å¿«ï¼‰

åœ¨ Central Brain çš„ `main.go` ä¸­æ·»åŠ èœå•è·¯ç”±æ³¨å†Œã€‚

æ‰¾åˆ° `main.go` ä¸­çš„è·¯ç”±æ³¨å†Œéƒ¨åˆ†ï¼Œæ·»åŠ ï¼š

```go
// åœ¨ main.go ä¸­ï¼Œè·¯ç”±æ³¨å†Œéƒ¨åˆ†æ·»åŠ 
if vuecmfDB != nil {
    RegisterMenuRoutes(r, vuecmfDB)
}
```

### æ–¹æ¡ˆ B: æ‰‹åŠ¨æµ‹è¯•èœå•æ•°æ®ï¼ˆéªŒè¯ï¼‰

**1. æµ‹è¯•èœå•æ•°æ®æ˜¯å¦å­˜åœ¨ï¼š**
```bash
PGPASSWORD=vuecmf psql -h localhost -U vuecmf -d zervigo_mvp \
  -c "SELECT menu_id, title, path FROM vuecmf_menu ORDER BY sort_num;"
```

**2. æµ‹è¯• API æ˜ å°„ï¼š**
```bash
curl -X POST http://localhost:9000/api/v1/mapping/get_api_map \
  -H "Content-Type: application/json" \
  -d '{"data":{"table_name":"menu","action_type":"nav"}}' | jq .
```

### æ–¹æ¡ˆ C: æœ€ç®€å•çš„ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

ç›´æ¥åœ¨ Central Brain æ·»åŠ ä¸€ä¸ªç®€å•çš„é™æ€èœå•ç«¯ç‚¹ï¼š

åœ¨ `central-brain/main.go` çš„ router æ³¨å†Œéƒ¨åˆ†æ·»åŠ ï¼š

```go
// ä¸´æ—¶èœå•å¯¼èˆªç«¯ç‚¹
r.GET("/api/v1/router/menu/nav", func(c *gin.Context) {
    // ä»æ•°æ®åº“è¯»å–èœå•
    query := `SELECT menu_id, pid, model_id, title, path, icon, sort_num, status 
              FROM vuecmf_menu WHERE status = 10 ORDER BY sort_num`
    
    rows, err := vuecmfDB.Query(query)
    if err != nil {
        c.JSON(200, gin.H{"code": 500, "msg": "æŸ¥è¯¢å¤±è´¥", "data": nil})
        return
    }
    defer rows.Close()
    
    menus := []map[string]interface{}{}
    for rows.Next() {
        var id, pid, mid, sort, status int
        var title, path, icon sql.NullString
        rows.Scan(&id, &pid, &mid, &title, &path, &icon, &sort, &status)
        menus = append(menus, map[string]interface{}{
            "id": id, "pid": pid, "model_id": mid,
            "title": title.String, "path": path.String,
            "icon": icon.String, "sort_num": sort, "status": status,
        })
    }
    
    c.JSON(200, gin.H{"code": 200, "msg": "success", "data": menus})
})
```

## ğŸ“ å®Œæ•´ä¿®å¤æµç¨‹

### æ­¥éª¤ 1: åœæ­¢ Central Brain
```bash
# æ‰¾åˆ° Central Brain çš„è¿›ç¨‹
ps aux | grep central-brain | grep -v grep

# åœæ­¢è¿›ç¨‹ (å‡è®¾ PID æ˜¯ 12345)
kill <PID>
```

### æ­¥éª¤ 2: ä¿®æ”¹ä»£ç 

ç¼–è¾‘ `/Users/szjason72/gozervi/zervigo.demo/shared/central-brain/main.go`

åœ¨è·¯ç”±æ³¨å†Œéƒ¨åˆ†æ·»åŠ ï¼š
```go
// æ³¨å†Œèœå•è·¯ç”±
RegisterMenuRoutes(r, vuecmfDB)
```

### æ­¥éª¤ 3: é‡å¯ Central Brain
```bash
cd /Users/szjason72/gozervi/zervigo.demo/shared/central-brain
go run . &
```

### æ­¥éª¤ 4: éªŒè¯ä¿®å¤
```bash
# æµ‹è¯•èœå•æ¥å£
curl http://localhost:9000/api/v1/router/menu/nav | jq .

# åº”è¯¥è¿”å›
{
  "code": 200,
  "msg": "success",
  "data": [
    {
      "id": 1,
      "title": "é¦–é¡µ",
      "path": "/dashboard",
      ...
    }
  ]
}
```

### æ­¥éª¤ 5: åˆ·æ–°æµè§ˆå™¨
```
http://localhost:8081
```

åº”è¯¥çœ‹åˆ°å®Œæ•´çš„åå°é¡µé¢ï¼Œä¸å†æ˜¯ç©ºç™½é¡µï¼

## ğŸ¯ é¢„æœŸç»“æœ

- âœ… ç™»å½•æˆåŠŸ
- âœ… èœå•æ•°æ®åŠ è½½æˆåŠŸ
- âœ… æ˜¾ç¤ºåå°ç®¡ç†ç•Œé¢
- âœ… å·¦ä¾§èœå•æ æ˜¾ç¤º

## âš ï¸ å¦‚æœè¿˜æ˜¯ç©ºç™½é¡µ

è¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼Œæ£€æŸ¥æ˜¯å¦è¿˜æœ‰å…¶ä»–é”™è¯¯ï¼Œå¹¶å°†é”™è¯¯æˆªå›¾ç»™æˆ‘ã€‚

